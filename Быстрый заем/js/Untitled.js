function substr_count(haystack, needle, offset, length) {    var pos = 0,        cnt = 0;    haystack += '';    needle += '';    if (isNaN(offset)) {        offset = 0;    }    if (isNaN(length)) {        length = 0;    }    offset--;    while ((offset = haystack.indexOf(needle, offset + 1)) != -1) {        if (length > 0 && (offset + needle.length) > length) {            return false;        } else {            cnt++;        }    }    return cnt;}(function($) {	$.fn.regmask = function(options){        var regexp = new RegExp(options.mask);        this.attr('maxlength', options.maxlength);        this.focusout(function() {        	var $this = $(this);			$this.val($this.val().replace(/\s{1,}/g, ' '));			$this.val($this.val().replace(/-{1,}/g, '-'));			$this.val($.trim($this.val()));			$this.val($this.val().toString().replace(/^-+/, ''));			if(!regexp.test($this.val())) {				$this.val('');			}			if(options.check_decimal) {				if($this.val() < options.min_val) $this.val(options.min_val);				if($this.val() > options.max_val) $this.val(options.max_val);			}		});		this.keyup(function(e) {			var val = new String($(this).val());			//backspace, delete, and escape get special treatment			if(e.keyCode != 8 || e.keyCode != 46 || e.keyCode != 27){				if(!regexp.test(val)) {					e.preventDefault();					$(this).val(val.substr(0, val.length-1));					return false;				}			}		});		this.keydown(function(e) {			var val = new String($(this).val());			if(e.keyCode == 109 || e.keyCode == 189) { //dash				if(options.count_dash) {					if(substr_count(val, '-', 0, val.length) >= 1) {						e.preventDefault();					}				}				if(val.length == 0) {					e.preventDefault();				}			}			if(e.keyCode == 32) { //space				if(val.length == 0) {					e.preventDefault();				}			}		});        return this;    };    /*default options*/	$.fn.regmask.defaults = {		mask: /^[А-Яа-яЁё -]*$/, //default mask		maxlength: 25, // defaultmaxlength		count_dash: true,		check_decimal: false, // check decimal for max/min val, use only with numeric mask  /^[0-9]*$/		min_val: 0,	// default min val		max_val: 10000 // default max val	}})(jQuery);(function($){	$(function(){        var csrf_token = $('#YII_CSRF_TOKEN').val();        /*$("body").bind("ajaxSend", function(elm, xhr, s){            if (s.type == "POST") {                xhr.setRequestHeader('X-CSRF-Token', csrf_token);            }        });*/        function showRegion() {            $('div#region').css("display", "");            $('div#region_show').css("display", "none");            $('div input#edit-indexcode').val('000000');            $('div input#edit-indexcode').attr("disabled",true);            $('div input#edit-indexcode').css("background", "linear-gradient(to bottom, #ddd 0%, #ddd 100%) repeat scroll 0 0 transparent");            $('div input#edit-indexcode').css("color", "#ddd");        }        $('#edit-indexcode').change(function() {            if ($('#edit-indexcode').val().length == 6) {                $.getJSON("/orders/GetRegion/index/"+$('#edit-indexcode').val(), function(response) {                    if (response.status == 'ok') {                       //if (response.index != $('#edit-indexcode').val()) {                            //alert("Вы ввели устаревший почтовый индекс: "+$('#edit-indexcode').val()+", ваш текущий индекс: "+response.index);                            //$('#edit-indexcode').val(response.index);                        //}                        $.getJSON("/orders/CheckRegion/region/"+response.region, function(response2) {                            if (response2.status == 'ok') {                                $("#edit-regis-region2 [value='"+response2.region_id+"']").attr("selected", "selected");                            } else {                                alert('Ошибка, выберите регион!');                                showRegion();                            }                        });                    } else {                        alert('Ошибка, выберите регион!');                        showRegion();                    }                });            }        }).keyup();		/*var previousRodstvo;		$('.rodstvo').focus(function () {			previousRodstvo = $(this).find('option').eq(this.selectedIndex).val();			//console.log(previousRodstvo);		});				$('.rodstvo').change(function () {			var num = this.selectedIndex;			var id = $(this).attr('id');			var parent = this;			$( "select.rodstvo" ).each(function(index) {				var ul = $('ul.rodstvo-selectBox-dropdown-menu').eq(index);				if(id != $(this).attr('id')){					$(this).find('option[value="'+$(parent).find('option').eq(num).val()+'"]').remove();					ul.find('li a[rel="'+$(parent).find('option').eq(num).val()+'"]').parent().remove();					//alert(previousRodstvo);					//alert($(this).find('option[value="'+previousRodstvo+'"]').val());					if (typeof previousRodstvo != 'undefined' && !$(this).find('option[value="'+previousRodstvo+'"]').val()){							$(this).find('option').eq(parseInt($(parent).find('option[value="'+previousRodstvo+'"]').index()) - 1).after($('<option value="'+$(parent).find('option[value="'+previousRodstvo+'"]').val()+'">'+$(parent).find('option[value="'+previousRodstvo+'"]').text()+'</option>'));						ul.find('li').eq(parseInt($(parent).find('option[value="'+previousRodstvo+'"]').index()) - 1).after('<li class=""><a rel="'+$(parent).find('option[value="'+previousRodstvo+'"]').val()+'">'+$(parent).find('option[value="'+previousRodstvo+'"]').text()+'</a></li>');						}				}			});			//previousRodstvo = $(parent).find('option').eq(num).val();		});*/						var setInterIterations1 = 0,			time_clouds = 3000,			setInterIterations2 = 0,			setInterIterations = 0,			clouds = $('#clouds'),			clouds2 = $('#clouds2');		clouds.width($('.clouds').first().outerWidth()*$('.clouds').length);		clouds2.width($('.clouds2').first().outerWidth()*$('.clouds2').length).css('marginLeft', -$(window).width());		var moveclouds = function() {			$('.clouds').first().animate({				marginLeft: -$('.clouds').first().outerWidth()			}, 35000, 'linear', function() {				clouds.find('.clouds').first().css('marginLeft', '0').appendTo(clouds);				moveclouds();			});		}		var moveclouds2 = function() {			$('.clouds2').last().animate({				marginRight: -$('.clouds2').last().outerWidth()			}, 35000, 'linear', function() {				clouds2.find('.clouds2').last().css('marginRight', '0').prependTo(clouds2);				moveclouds2();			});		}		moveclouds();		moveclouds2();		function numberFormat(str){		   return str.replace(/(\s)+/g, '').replace(/(\d{1,3})(?=(?:\d{3})+$)/g, '$1 ');		};		function trim(str) {			if (str) return str.replace(' ', '');		};		function calcTax(summ, days, tax) {			return summ*tax*days;		};		///!!!!!!!!		function put_money_summ() {			var percent = parseInt(trim($('#order_percent').attr('value')))/100;			if (!percent || percent==0) percent = 0.02;			var sum = parseInt(trim($('#edit-money').attr('value'))),				time = parseInt(trim($('#edit-time').attr('value'))),				output = sum*time*percent + sum + '';				if ($('#cupon_percent').val()!='') output = parseInt(output) - parseInt(sum*time*percent)*(parseInt($('#cupon_percent').val())/100);			//$('#money_summ_1').text(numberFormat(output));			$('#money_summ_1').text(output);		};		function put_mask(){            $('#edit-organization-post, #edit-surname, #edit-surname2, #edit-fieldset2 #edit-name, #edit-fieldset2-2 #edit-name2, #edit-fathername2, #edit-fathername, #edit-mothers-surname').regmask({mask: /^[А-Яа-яЁё-]*$/, maxlength: 25, count_dash: true});			$('#edit-fio1, #edit-fio2, #edit-fio3').regmask({mask: /^[А-Яа-яЁё -]*$/, maxlength: 50, count_dash: true});			var curyear = new Date().getFullYear();			$('#edit-year-of-birth, #edit-year-of-birth2').regmask({				mask: /^[0-9]*$/,				maxlength: 4,				check_decimal: true,				min_val: 1900,				max_val: curyear-21 // only 21 year old			});            $('#edit-pass-seria, #edit-pass-number, #edit-pass-seria2, #edit-pass-number2, #edit-regis-index, #edit-live-index').focusout(function() {				if(parseInt($(this).val()) == 0) {					$(this).val('');				}			});            $('#edit-pass-seria, #edit-pass-seria2').mask("9999", {placeholder: ''});            $('#edit-pass-number, #edit-pass-number2').mask("999999", {placeholder: ''});            $('#edit-pass-code').mask("999-999", {placeholder: ''});            $('#edit-regis-index, #edit-live-index').mask('999999', {placeholder: ''});            $('#edit-home-number, #edit-mobile-number, #edit-reenter-mobile-number, #edit-home-number1, #edit-mobile-number1, #edit-home-number2, #edit-mobile-number2, #edit-home-number3, #edit-mobile-number3, #edit-mobile-number22, #edit-organization-telephone, #edit-manager-phone').mask("+7 (999) 999-99-99",{placeholder:''});            $('#edit-day-of-birth, #edit-day-of-birth2, #edit-month-of-birth, #edit-month-of-birth2, #edit-pass-day, #edit-pass-day2, #edit-pass-month, #edit-pass-month2').mask("9?9",{placeholder: ''});            $('#edit-pass-code').focusout(function() {                if($(this).val() == '000-000') $(this).val('');            });            $('#edit-pass-year, #edit-pass-year2').regmask({				mask: /^[0-9]*$/,				maxlength: 4,				check_decimal: true,				max_val: curyear			});			$("#edit-pass-year").focusout(function() {				if(parseInt($(this).val()) < parseInt($('#edit-year-of-birth').val())) {					$(this).val(parseInt($('#edit-year-of-birth').val())+14);				}			});            $("#edit-pass-year2").focusout(function() {                if(parseInt($(this).val()) < parseInt($('#edit-year-of-birth2').val())) {                    $(this).val(parseInt($('#edit-year-of-birth2').val())+14);                }            });            $('#edit-pass-who, #edit-pass-who2, #edit-regis-street, #edit-live-street').regmask({                mask: /^[А-Яа-яЁё .-]*$/,                maxlength: 256            });            $('#edit-regis-region2').mask("99", {placeholder: ''});			$('#edit-regis-city, #edit-live-city, #edit-place-of-birth, #edit-organization-adress').regmask({				mask: /^[А-Яа-яЁё0-9 .,-]*$/,				maxlength: 256			});			$('#edit-regis-home, #edit-regis-flat, #edit-live-home, #edit-live-flat, #orghouse').regmask({				mask: /^[0-9]*$/,				maxlength: 3,				check_decimal: true,				min_val: 1			});            $('#edit-indexcode').regmask({                mask: /^[0-9]*$/,                maxlength: 6,                check_decimal: true            });			$('#edit-regis-korpus, #edit-regis-build, #edit-live-korpus, #edit-live-build, #office, #orgpart, #orgstr').regmask({				mask: /^[0-9А-Яа-яЁё-]*$/,				maxlength: 3			});			$('#edit-organization').regmask({				mask: /^[А-Яа-яЁёa-zA-Z- .]*$/,				maxlength: 256			});			$('#edit-organization-income').regmask({				mask: /^[0-9]*$/,				maxlength: 12			});			$('#edit-organization-experience').regmask({				mask: /^[0-9]*$/,				maxlength: 3			});			$('#edit-manager').regmask({				mask: /^[А-Яа-яЁё -]*$/,				maxlength: 25			});		};		function set_font_size(elem){			var span = '';				font = 38;				span = '<span id="fake_span" style="display:none; font-size: ' + font + 'px; font-family: newfont, Tahoma;">' + elem.val() + '</span>';				$('body').append(span);				$span = $('#fake_span');				while (($span.width() > 400) && (font > 14))				{					font--;					$span.css('font-size', font + 'px');				};				if ( ($span.width() > 400) ) elem.css('line-height', '20px'); else elem.css('line-height', '48px');				elem.css('font-size', font + 'px');				$span.remove();		};		var width;		function set_sizes(){			width = $('body').width();			$('#request-form').width( width );			$('.form-wrapper').css('margin-left', (width - 1000) / 2 + 'px').css('margin-right', ($('body').width() - 1000) / 2 + 'px');			/*$('#clouds2').width( width * 3 );			$('#clouds').width( width * 3 );*/		};		set_sizes();		$(window).resize(function(){			set_sizes();		})		put_mask();		var summ = $('#edit-money');		var period = $('#edit-time');		var summslide = $('#moneyslide');		var dayslide = $('#timeslide');		summslide.append('<div class="slider-img-container"></div>');		dayslide.append('<div class="slider-img-container"></div>');		summslide.slider({			max: 15000,			min: 1000,			step: 1000,			value: 5000,			slide: function(e, ui) {				summ.val(numberFormat(new String(ui.value)));				$('fieldset[name="start"]').find('span.orange strong').text(numberFormat(new String(ui.value)));				$('fieldset[name="start"]').find('span.blue strong').text(numberFormat(new String(parseFloat(calcTax(ui.value, dayslide.slider('values', 0), 0.02)))));				$('fieldset[name="start"]').find('span.green strong').text(numberFormat(new String(parseInt(trim($('fieldset[name="start"]').find('span.orange strong').text())) + parseInt(trim($('fieldset[name="start"]').find('span.blue strong').text())) )));				$('input[name="payment"]').val($('fieldset[name="start"]').find('span.green strong').text());//7.142857142857142				put_money_summ();			},			change: function(e, ui) {				$('#moneyslide .slider-img-container').css('width', $('#moneyslide .ui-slider-handle').css('left'));			}		});		$('#edit-rodstvo2, #edit-rodstvo3, #edit-organization-experience, #edit-surname, #edit-name, #edit-fathername, #edit-place-of-birth, #edit-mothers-surname, #edit-pass-who, #edit-pass-who2, #edit-regis-region, #edit-regis-city, #edit-regis-street, #edit-live-region, #edit-live-city, #edit-live-street, #edit-email, #edit-fio1, #edit-fio2, #edit-fio3, #edit-organization, #edit-organization-adress, #edit-organization-post, #edit-organization-income, #edit-manager').keyup(function(){			set_font_size($(this));		});        $('#edit-home-number, #edit-mobile-number, #edit-reenter-mobile-number, #edit-home-number1, #edit-mobile-number1, #edit-home-number2, #edit-mobile-number2, #edit-home-number3, #edit-mobile-number3, #edit-mobile-number22, #edit-organization-telephone, #edit-manager-phone').change(function (){            if((($(this).val())[4] == '0') || (($(this).val().substr(4,1)) == '1') || (($(this).val().substr(4,1)) == '2') || (($(this).val().substr(4,1)) == '7')) {                $(this).val('+7 () --');                $('#vnimatelno').css('display', 'none');                $('#nepravilnie').css('display', 'block');            }            else            {                $('#nepravilnie').css('display', 'none');                $('#vnimatelno').css('display', 'block');            };        });        $('#edit-day-of-birth, #edit-pass-day, #edit-day-of-birth2, #edit-pass-day2').change(function (){            if($(this).val() > 31) {                $(this).val(31);            };            if($(this).val() < 1) {                $(this).val('01');            };            if($(this).val() == 1) {                $(this).val('01');            };            if($(this).val() == 2) {                $(this).val('02');            };            if($(this).val() == 3) {                $(this).val('03');            };            if($(this).val() == 4) {                $(this).val('04');            };            if($(this).val() == 5) {                $(this).val('05');            };            if($(this).val() == 6) {                $(this).val('06');            };            if($(this).val() == 7) {                $(this).val('07');            };            if($(this).val() == 8) {                $(this).val('08');            };            if($(this).val() == 9) {                $(this).val('09');            };        });        $('#edit-month-of-birth, #edit-pass-month, #edit-month-of-birth2, #edit-pass-month2').change(function (){            if($(this).val() > 12) {                $(this).val(12);            };            if($(this).val() < 1) {                $(this).val('01');            };            if($(this).val() == 1) {                $(this).val('01');            };            if($(this).val() == 2) {                $(this).val('02');            };            if($(this).val() == 3) {                $(this).val('03');            };            if($(this).val() == 4) {                $(this).val('04');            };            if($(this).val() == 5) {                $(this).val('05');            };            if($(this).val() == 6) {                $(this).val('06');            };            if($(this).val() == 7) {                $(this).val('07');            };            if($(this).val() == 8) {                $(this).val('08');            };            if($(this).val() == 9) {                $(this).val('09');            };        });		$('#edit-fieldset1').mousemove(function(){			$('#moneyslide .slider-img-container').css('width', $('#moneyslide .ui-slider-handle').css('left'));			$('#timeslide .slider-img-container').css('width', $('#timeslide .ui-slider-handle').css('left'));		});		dayslide.slider({			max: 14,			min: 7,			value: 10,			slide: function(e, ui) {				period.val(numberFormat(new String(ui.value)));				$('fieldset[name="start"]').find('span.blue strong').text(numberFormat(new String(parseFloat(calcTax(summslide.slider('values', 0), ui.value, 0.02)))));				$('fieldset[name="start"]').find('span.green strong').text(numberFormat(new String(parseInt(trim($('fieldset[name="start"]').find('span.orange strong').text())) + parseInt(trim($('fieldset[name="start"]').find('span.blue strong').text())) )));				$('input[name="payment"]').val($('fieldset[name="start"]').find('span.green strong').text());				put_money_summ();			},			change: function(e, ui) {				$('#timeslide .slider-img-container').css('width', $('#timeslide .ui-slider-handle').css('left'));			}		});		put_money_summ();		$('#moneyslide .slider-img-container').css('width', $('#moneyslide .ui-slider-handle').css('left'));		$('#timeslide .slider-img-container').css('width', $('#timeslide .ui-slider-handle').css('left'));		summ.keyup(function() {			if(parseInt(trim($(this).val())) < summslide.slider("option", "min")) {				summslide.slider('option', 'value', summslide.slider("option", "min"));			} else {				if(parseInt(trim($(this).val())) > summslide.slider("option", "max")) {					summslide.slider('option', 'value', summslide.slider("option", "max"));				} else {					summslide.slider('option', 'value', parseInt(trim($(this).val())));				}			}			$(this).val(numberFormat($(this).val()));			put_money_summ();		});		summ.focusout(function() {			if(parseInt(trim($(this).val())) < summslide.slider("option", "min") || $(this).val() == '' || isNaN(trim($(this).val()))) {				$(this).val(numberFormat(new String(summslide.slider("option", "min"))));				$('fieldset[name="start"]').find('span.orange strong').text(numberFormat($(this).val()));				summslide.slider('option', 'value', summslide.slider("option", "min"));			}			if(parseInt(trim($(this).val())) > summslide.slider("option", "max")) {				$(this).val(numberFormat(new String(summslide.slider("option", "max"))));				$('fieldset[name="start"]').find('span.orange strong').text(numberFormat($(this).val()));			};			$(this).val(numberFormat($(this).val()));			put_money_summ();		});		period.keyup(function() {			if(parseInt(trim($(this).val())) < dayslide.slider("option", "min")) {				dayslide.slider('option', 'value', dayslide.slider("option", "min"));			} else {				if(parseInt(trim($(this).val())) > dayslide.slider("option", "max")) {					dayslide.slider('option', 'value', dayslide.slider("option", "max"));				} else {					dayslide.slider('option', 'value', parseInt(trim($(this).val())));				}			};			put_money_summ();		});		period.change(function() {			if(parseInt(trim($(this).val())) < dayslide.slider("option", "min") || $(this).val() == '') {				$(this).val(numberFormat(new String(dayslide.slider("option", "min"))));				dayslide.slider('option', 'value', dayslide.slider("option", "min"));			}			if(parseInt(trim($(this).val())) > dayslide.slider("option", "max")) {				$(this).val(numberFormat(new String(dayslide.slider("option", "max"))));			};			put_money_summ();		});		var time = 1000,		div4margin = $('#request-form > div'),		wrapper = $('#request-form');		wrapper.height($('#edit-fieldset1').height());		$('#next_button_1').click(function(){            div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});            $('#cloud').animate({'left': -$(window).width() + 'px'}, {duration: time});            $('#block-system-main-menu > .content').animate({'marginLeft': -$(window).width() * 2 + 'px'}, {duration: time});            $('h1.top').animate({'marginLeft': -$(window).width() * 2 + 'px'}, {duration: time});            $('#node-fronttext-wrap').animate({                marginLeft: -$(window).width() * 2 + 'px',                height: 0            }, {duration: time});            $('#header').append('<div id="scale_walkthrought"><div id="text_walkthrought">Займ <span class="money"></span><br />на <span class="days"></span></div><div id="fire_walkthrought"></div><div id="rocket_walkgrought"></div></div>');            $('#text_walkthrought .money').html( $('#edit-money').val() + ' <span style="font-family: rubl; font-weight: bold;">i</span>');            $('#text_walkthrought .days').text( $('#edit-time').val() + ' дней');            wrapper.animate({height: $('#edit-fieldset2-2').height() + 'px'}, {duration: time});            $('#rocket_walkgrought').animate({'left': '+=488px'}, {duration: time});            $('#fire_walkthrought').animate({'width': '+=488px'}, {duration: time});            $(window).scrollTop(340);		});        var obj = '';        var options = {                beforeSubmit: function() {                },                success: function(data) {                    var obj = JSON.parse(data);                    if (obj.status == 'ok') {                        div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});                        $('#rocket_walkgrought').animate({'left': '+=82.5px'}, {duration: time});                        $('#fire_walkthrought').animate({'width': '+=82.5px'}, {duration: time});                        wrapper.animate({height: $('#edit-fieldset5').height() + 'px'}, {duration: time});                    }                    if (obj.status == 'ok2') {                        $(window).scrollTop(340);                        $('#edit-fieldset7 #edit-submit')                            .css({'color' : '#fdce69', 'cursor': 'default'})                            .attr('disabled', true);                        div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});                        wrapper.animate({height: $('#edit-fieldset8').height() + 'px'}, {duration: time});                    }                }	        };		$('#request-form').validate({			submitHandler: function(form) {				$(form).ajaxSubmit(options);                //alert('123');			},			rules: {			},            errorPlacement: function(error, element) {                var er = element.attr("name");                //alert(er);            }		});		$('#edit-cupon').bind('change mouseleave', function(){            this.value = $.trim(this.value);			if (this.value && this.value!=''){				$.getJSON("/orders/checkcupon/?cupon="+this.value, function(response) {					if (response.status == 'ok') {						$('#cupon_percent').val(response.percent);						put_money_summ();                        $('#cupon_suffix').html('<span style="color:green">код верный, скидка '+response.percent+'%</span>');					}else{						$('#cupon_suffix').html('<span style="color:red">код не верный</span>');					}				})			}        });		        /**         * SMS Checking         * @auhor Igor Ukolov aka Hamer         **/        var SmsChecker = {            checked: false,            deferred: null,			errors: '',            send: function() {                return (this.deferred = $.getJSON('/orders/sendsms', {phone: $('#edit-mobile-number22').val()}));            },            check: function(code) {                return $.getJSON('/orders/checksmscode', {code: code});            }        };		$('#edit-mobile-number22').bind('change mouseleave', function(){			if($(this).val()!='' && $(this).val()!='+7 () --'){                if ($(this).val().length == 18) {                    var phone = $(this).val();                    $.ajax({                          type: 'POST',                          url: '/orders/checkUser',                          data: {phone:$(this).val(), YII_CSRF_TOKEN:csrf_token},                          dataType: 'JSON'                    }).done(function( json ) {                            if(json.status =='exist') {                                $('#edit-mobile-number22').val('');                                if(confirm('Ваш номер уже есть в системе. Вы можете войти в систему через форму логина или востановить свой пароль!')){                                    phone = phone.replace('+', '');                                    window.location.href = "/users/login/repeat/"+phone+"/";                                }                            }                            }).fail(function() {});                }			}		});        // Bind sms checking        $('#edit-smscode').bind('change mouseleave', function(){            this.value = $.trim(this.value);            this.value && this.value.length == 5 && !SmsChecker.checked && SmsChecker.check(this.value).done(                function(response){                    if (response.msg) {                        $('#sms-check-info').html('<span style="color:red">'+response.msg+'</span>');                        return;                    }                    if (response.status == 'ok') {                        $('#sms-check-info').html('<span style="color:green">код верный</span>');                        //$('.next_button_2').show();                        $('#wait-sms-code').remove();                        enableSubmitButton();                        $('.form-item-reenter-mobile-number').hide();                        $('.container-sms-info').hide();                        SmsChecker.checked = true;                        // Set wrapper height                        wrapper.animate({height: $('#edit-fieldset3').height() + 'px'}, {duration: time});                    } else {                        $('#sms-check-info').html('<span style="color:red">код не верный</span>');                    }                }            );        });        var enableSubmitButton = function() {            $('#edit-fieldset3 #edit-submit')                .css({'color' : '#fff', 'cursor' : 'pointer'})                .attr('disabled', false)                .attr('disabled', false);        }        var disableSubmitButton = function() {           $('#edit-fieldset3 #edit-submit')                .css({'color' : '#fdce69', 'cursor': 'default'})                .attr('disabled', true);        }        disableSubmitButton();        $('.form-item-reenter-mobile-number').hide();        $('#change-mobile-number').click(function(){            $('.form-item-reenter-mobile-number').show();            $('#edit-reenter-mobile-number').val($('#edit-mobile-number').val());            // Set wrapper height            wrapper.animate({height: $('#edit-fieldset3').height() + 'px'}, {duration: time});            return false;        });        $('#edit-mobile-number').bind('change', function(){            $('#mobile-number-info').text(this.value);            $('#edit-reenter-mobile-number').val(this.value);        });        $('#edit-reenter-mobile-number').bind('change', function(){            $('#edit-mobile-number').val(this.value);            $('#mobile-number-info').text(this.value);        });        $('#resend-sms').click(function(){            $.getJSON("/orders/smslimit", function(response) {                if (response.status == 'ok') {                    if(parseInt(response.limit) == 0) {                        SmsChecker.send();                        sendRepeatSms(response.time_limit);                        alert('Отправлено!');                        return false;                    }                    if(parseInt(response.limit) == 2) {                        alert('Отправка повторного смс, разрешена не чаще одного раза в ' + response.time_limit + ' сек.');                    }                    if(parseInt(response.limit) == 1) {                        alert('Превышен лимит отправки повторных сообщений');                    }                } else {                    alert('Ошибка, попробуйте позже!');                }            })        });				function microzaim() {			yaCounter18908710.reachGoal('microzaim');			return true;		};		$('.truevasya').click(function() {			microzaim();		});        $('#edit-fieldset2-2 .next_button_2').click(function(){            $('#edit-fieldset3 .step_before').attr('data-index' , '98') ; //устанавливаем последнюю кнопку назад в режим минианкеты            if ($('#edit-email').val() == '') {                $('#edit-email').val('НЕТ');            }            if ($('#edit-vk').val() == '') {                $('#edit-vk').val('НЕТ');            }        });        $('#edit-fieldset3 #edit-submit').click(function(){            $(this).hide();            $('#otpravka_notice').css('display', 'block');            $(window).scrollTop(340);        });        /**         * END sms checking         */		jQuery.extend(jQuery.validator.messages, {required: 'Это поле обязательно для заполнения'});		/**$('#edit-fieldset2 .next_button_2').click(function(){			alert('2');		});*/        var sendRepeatSms = function(lost_seconds) {            var t=setInterval(function(){                $('#resend-sms').html("До следующей отправки осталось: " + lost_seconds--);                if(lost_seconds == 0) {                    $('#resend-sms').html("Отправить ещё раз");                    clearInterval(t);                }            }, 1000);        }		$('.next_button_2').click(function () {			// sms protection popup			if ($(this).data('index') == 'sms_protect') {				if (parseInt($("#smsDisable").val()) == 0) {					SmsChecker.send().done(							function (response) {								if (response.msg && response.msg != '') {									SmsChecker.errors = response.msg;									alert(SmsChecker.errors);								} else {                                    //$('#resend-sms').html("До следующей отправки осталось: " + response.time_limit);                                    sendRepeatSms(response.time_limit);                                }							}					);				} else {					enableSubmitButton();				}			}            if ($(this).data('index') == 'sms_protect') {                $(this).hide();                $('#sms-protect').show();                wrapper.animate({height: $('#edit-fieldset3').height() + 'px'}, {duration: time});                return false;            }            $(window).scrollTop(340);            if (($(this).attr('data-index') == '1'))            {                var valid = true;                $(this).closest('.form-wrapper').find('input').each(function(){                    if ($(this).attr('type') != 'checkbox') {                        //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                        if (!$(this).valid()) valid = false;                    }                });                $(this).closest('.form-wrapper').find('textarea').each(function(){                    //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                    if (!$(this).valid()) valid = false;                });                $(this).closest('.form-wrapper').find('select').each(function(){                    //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                    if (!$(this).valid()) valid = false;                });                if (valid)                {                    div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});                    $('#rocket_walkgrought').animate({'left': '+=82.5px'}, {duration: time});                    $('#fire_walkthrought').animate({'width': '+=82.5px'}, {duration: time});                    var index = parseInt($(this).attr('data-index')),                        fieldset_height = $('#edit-fieldset' + (index + 2)).height();                    wrapper.animate({height: fieldset_height}, {duration: time});                }            };            /*if (($(this).attr('data-index') == '6'))            {                var valid = true;                $(this).closest('.form-wrapper').find('input').each(function(){                    if ($(this).attr('type') != 'checkbox') {                        //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                        if (!$(this).valid()) valid = false;                    }                });                $(this).closest('.form-wrapper').find('textarea').each(function(){                    //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                    if (!$(this).valid()) valid = false;                });                if (valid)                {                    div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});                    //wrapper.animate({height: $('#edit-fieldset6_1').height() + 'px'}, {duration: time});					wrapper.animate({height: $('#edit-fieldset7').height() + 'px'}, {duration: time});                    $('#mult8_op').delay(1000).animate({opacity: 1}, {duration:3000}, 1000 );                }            };*/						/*if (($(this).attr('data-index') == '6_1'))            {                var valid = true;                $(this).closest('.form-wrapper').find('input').each(function(){                    if ($(this).attr('type') != 'checkbox') {                        //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                        if (!$(this).valid()) valid = false;                    }                });                $(this).closest('.form-wrapper').find('textarea').each(function(){                    //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                    if (!$(this).valid()) valid = false;                });                if (valid)                {                    div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});                    wrapper.animate({height: $('#edit-fieldset6_2').height() + 'px'}, {duration: time});					//wrapper.animate({height: $('#edit-fieldset7').height() + 'px'}, {duration: time});                    $('#mult8_op').delay(1000).animate({opacity: 1}, {duration:3000}, 1000 );                }            };*/						/*if (($(this).attr('data-index') == '6_2'))            {                var valid = true;                $(this).closest('.form-wrapper').find('input').each(function(){                    if ($(this).attr('type') != 'checkbox') {                        //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                        if (!$(this).valid()) valid = false;                    }                });                $(this).closest('.form-wrapper').find('textarea').each(function(){                    //alert($(this).attr('name') + ' name: ' + $(this).attr('name') + $(this).valid() + 'unknow');                    if (!$(this).valid()) valid = false;                });                if (valid)                {                    div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});					wrapper.animate({height: $('#edit-fieldset7').height() + 'px'}, {duration: time});                    $('#mult8_op').delay(1000).animate({opacity: 1}, {duration:3000}, 1000 );                }            };*/		});        /*$('#edit-fieldset5 .edit-check').click(function(){            $('#edit-fio1').val('');            $('#edit-home-number1').val('');            $('#edit-mobile-number1').val('');						$('#edit-fio2').val('');            $('#edit-home-number2').val('');            $('#edit-mobile-number2').val('');						$('#edit-fio3').val('');            $('#edit-home-number3').val('');            $('#edit-mobile-number3').val('');            $('#edit-organization').val('');            $('#edit-organization-telephone').val('');            $('#edit-organization-adress').val('');            $('#edit-organization-post').val('');            $('#edit-organization-income').val('');            $('#edit-organization-experience').val('');            $('#edit-manager').val('');            $('#edit-manager-phone').val('');            div4margin.animate({'marginLeft': '-=' + width + 'px'}, {duration: time});            wrapper.animate({height: $('#edit-fieldset6').height() + 'px'}, {duration: time});            $('#mult7_op').delay(1000).animate({opacity: 1}, {duration:3000}, 1000 );        });*/        $('#edit-fieldset2-2 .step_before').click(function(){            $('#scale_walkthrought').remove();            $('#cloud').animate({'left': '0px'}, {duration: time});            $('#block-system-main-menu > .content').animate({'marginLeft': '0px'}, {duration: time});            $('h1.top').animate({'marginLeft': '0px'}, {duration: time});        });		$('.step_before').click(function(){			//if ($(this).data('index') != 6)			//{				div4margin.animate({'marginLeft': '+=' + width + 'px'}, {duration: time});				if ($(this).closest('.fieldset-wrapper').find('.next_button_2').attr('data-index') != '4ext')				{					$('#rocket_walkgrought').animate({'left': '-=82.5px'}, {duration: time});					$('#fire_walkthrought').animate({'width': '-=82.5px'}, {duration: time});					if ($(this).closest('.fieldset-wrapper').find('.next_button_2').attr('data-index') != '4ext')					{                        if($(this).data('index') == 3) {                            var index = 3;                            wrapper.animate({height: $('#edit-fieldset2-2').height() + 'px'}, {duration: time});                            $('#user_name').text( ' ' + $('#edit-name').val() + ' ' + $('#edit-fathername').val());                            var prefix_height = $('#edit-fieldset2-2 .prefix').height();                            $('#edit-month-of-birth').css('top', (prefix_height + 377) + 'px');                            $('#edit-year-of-birth').css('top', (prefix_height + 377) + 'px');                            $('.form-type-radio').css('top', (prefix_height + 262) + 'px');                        } else {						    var index = parseInt($(this).attr('data-index'));						    wrapper.animate({height: $('#edit-fieldset' + (index)).height() + 'px'}, {duration: time});                        }					}				}			//}			if($(this).data('index') == 1) {				$('#node-fronttext-wrap').animate({					marginLeft: '0',					height: '100%',					width: '100%'				}, {duration: time});			}		});        $("#edit-fieldset2-2 #next_button_3").hide();		$(".form-type-radio").dgStyle();		$('.checkbox').dgStyle();		$('.form-type-radio').eq(1).css('left', '443px');		$('.node-oferta .field-name-body').jScrollPane({autoReinitialise: true, autoReinitialiseDelay: 3000});		$('#edit-family-place').selectBox();		$('#edit-rodstvo1, #edit-rodstvo2, #edit-rodstvo3').selectBox();		$('ul.selectBox-dropdown-menu').each(function(){			$(this).find('li a').eq(0).css('border-top', 'none');		});		$('#edit-fieldset2-2 .selectBox, #edit-fathername, #edit-mothers-surname, #edit-pass-code, #edit-regis-flat, #edit-live-flat, #edit-email, #edit-mobile-number1, #edit-mobile-number2, #edit-mobile-number3, #edit-manager-phone').keydown(function(e){			if (e.keyCode == 9) return false;		});         $('#edit-fieldset3 .checkbox').click(function(){            if ($(this).attr('data-checked') == 'true') {                $('#edit-fieldset3 .next_button_2').show();            } else {                $('#edit-fieldset3 .next_button_2, #sms-protect').hide();            }        });        $('#edit-fieldset2-2 .checkbox').click(function(){            if ($(this).attr('data-checked') == 'true') {                $("#edit-fieldset2-2 #next_button_3").show();            } else {                $("#edit-fieldset2-2 #next_button_3").hide();            }        });		var subdomainlist = $('#subdomain_list');		$('#city').click(function() {			$(this).hide();			$('#subdomain_list_chzn').show();		});		subdomainlist.chosen({no_results_text: "Город не найден"}).change(function() {			location.href = $(this).val();		});	});})(jQuery)var x = [1, 2, 3];jQuery.each(x, function(index, value) {  console.log("index", index, "value", value);});